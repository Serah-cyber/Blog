
[{"content":"","date":"17 February 2026","externalUrl":null,"permalink":"/Blog/tags/blue-team/","section":"Tags","summary":"","title":"Blue-Team","type":"tags"},{"content":"","date":"17 February 2026","externalUrl":null,"permalink":"/Blog/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":" Investigating Suspicious ICMP Traffic in a SOC Lab Using Wireshark # Alert Summary # The SIEM generated a medium-severity alert for unusual ICMP traffic between two internal hosts.\nThe alert indicated:\nLarge ICMP packet sizes Repeated echo requests High frequency within a short time window Possible concern: Data exfiltration over ICMP (ICMP tunneling).\nEnvironment # Tool : Wireshark Data Source: Provided PCAP file from SOC lab Alert Type: Network anomaly detection Protocol: ICMP Step 1 — Identify ICMP Traffic # Open the PCAP file in Wireshark.\nApply the following display filter:\nicmp This isolates all ICMP traffic.\nObserve:\nSource IP Destination IP Type (Echo request / reply) Packet length Step 2 — Check ICMP Packet Types # To focus only on echo requests:\nRun:\nicmp.type = = 8 Echo reply:\nicmp.type = = 0 In this case, I observed a high number of echo requests from:\n192.168.1.25 → 192.168.1.10\nThe volume appeared abnormal compared to normal ping behavior.\nStep 3 — Investigate Packet Size # Large ICMP packets can indicate tunneling or embedded data.\nApply:\nicmp \u0026amp;\u0026amp; frame.len \u0026gt; 200 Normal ping packets are typically small (around 64–98 bytes).\nHowever, I observed multiple packets exceeding 1000 bytes.\nThis is a strong anomaly indicator.\nStep 4 — Analyze Payload Content # Click on one of the large ICMP packets.\nExpand:\nInternet Control Message Protocol Data section In normal pings, payloads are predictable or random patterns.\nIn this case:\nPayload length was unusually large Repetitive structured patterns were visible Data did not resemble normal ping behavior This suggests possible encoded or tunneled data.\nStep 5 — Check Traffic Pattern # To analyze frequency:\nStatistics → Conversations → ICMP\nI observed:\nHigh packet count Continuous flow Not typical diagnostic behavior Legitimate ping activity is usually:\nShort bursts Low frequency Limited duration This traffic was persistent.\nStep 6 — Rule Out False Positives # Possible legitimate causes:\nNetwork monitoring tools Large file transfer testing Misconfigured internal tools No documentation indicated approved ICMP-based tools.\nGiven:\nLarge packet size High frequency Structured payload The activity is suspicious.\nVerdict # This activity is highly indicative of:\nICMP tunneling Potential data exfiltration attempt The alert is likely a True Positive.\nEscalation to incident response is recommended.\nMITRE ATT\u0026amp;CK Mapping # T1048 — Exfiltration Over Alternative Protocol T1095 — Non-Application Layer Protocol Lessons Learned # Packet size matters in anomaly detection. Not all ICMP traffic is benign. Frequency + size + payload structure together indicate malicious intent. Wireshark filtering is essential for rapid triage. Blue Team Takeaway # ICMP is often overlooked because it is considered harmless.\nHowever, attackers may abuse it for:\nData exfiltration Command-and-control Network reconnaissance Blue teams should implement detection rules for:\nAbnormally large ICMP packets High-frequency echo requests Persistent ICMP sessions ","date":"17 February 2026","externalUrl":null,"permalink":"/Blog/posts/investigating-suspicious-icmp/","section":"Posts","summary":"","title":"Investigating Suspicious ICMP Traffic in a SOC Lab Using Wireshark","type":"posts"},{"content":"","date":"17 February 2026","externalUrl":null,"permalink":"/Blog/tags/network-analysis/","section":"Tags","summary":"","title":"Network-Analysis","type":"tags"},{"content":"","date":"17 February 2026","externalUrl":null,"permalink":"/Blog/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":"","date":"17 February 2026","externalUrl":null,"permalink":"/Blog/","section":"SERAHER","summary":"","title":"SERAHER","type":"page"},{"content":"","date":"17 February 2026","externalUrl":null,"permalink":"/Blog/tags/soc/","section":"Tags","summary":"","title":"Soc","type":"tags"},{"content":"","date":"17 February 2026","externalUrl":null,"permalink":"/Blog/categories/soc-labs/","section":"Categories","summary":"","title":"SOC Labs","type":"categories"},{"content":"","date":"17 February 2026","externalUrl":null,"permalink":"/Blog/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"17 February 2026","externalUrl":null,"permalink":"/Blog/tags/wireshark/","section":"Tags","summary":"","title":"Wireshark","type":"tags"},{"content":"","date":"16 November 2025","externalUrl":null,"permalink":"/Blog/tags/analysis/","section":"Tags","summary":"","title":"Analysis","type":"tags"},{"content":"","date":"16 November 2025","externalUrl":null,"permalink":"/Blog/tags/icmp/","section":"Tags","summary":"","title":"Icmp","type":"tags"},{"content":" Introduction to ICMP # The Internet Control Message Protocol (ICMP) is a core component of the Internet Protocol (IP) suite. While often overlooked, it plays a vital, non-data transfer role in network operations.\nWhat ICMP Is and Its Primary Purpose # ICMP acts as the error reporting and diagnostic mechanism for the IP layer. It is NOT used to exchange data between systems (like TCP or UDP), but rather to communicate information about network issues.\nCommon utilities that use ICMP:\nping: Uses Echo Request (Type 8) and Echo Reply (Type 0). traceroute: Uses Time Exceeded (Type 11) messages. How an ICMP Message is Transmitted and Captured # ICMP messages are encapsulated directly within an IP packet.\nTransmission # Trigger: An event occurs (e.g., a host is unreachable, or a ping command is issued). Encapsulation: The ICMP message (containing its Type, Code, and Checksum) is placed into the Data/Payload section of a standard IP packet. Delivery: The IP packet is routed across the network like any other packet. Capture # ICMP packets are easily captured using network analysis tools like Wireshark. Since they travel across the network, they are visible to any device in the path or any sniffing tool.\nWhat Happens In Transit? # Time-to-Live (TTL) # ICMP is integral to preventing routing loops. Every router decrements the TTL field in the IP header.\nWhen a router receives a packet and the TTL is decremented to zero, the router discards the packet and sends an ICMP Type 11 (Time Exceeded) message back to the source. This is how traceroute works! Unreachable Destinations # If a router determines a host or network is unreachable (e.g., an incorrect route exists), it sends an ICMP Type 3 (Destination Unreachable) message back to the source host.\nAnalyzing an ICMP Packet (Security Perspective) # Analyzing the ICMP packet header is crucial for security monitoring.\nField Security Relevance Type The most important field. Type 8 (Echo Request) is Ping. Other types can indicate scanning or malicious activity. Code Provides specifics for the Type (e.g., Code 13 for Type 3 indicates \u0026ldquo;Communication Administratively Filtered\u0026rdquo;). Data/Payload The payload of a Ping is often filled with random data, but it can be used for ICMP Tunneling to covertly exfiltrate data. Detecting ICMP Tunneling # Defensive analysis should look for unusually large ICMP packets or ICMP packets with an unusual frequency or a payload that looks like encoded data.\nWireshark ICMP Analysis # This section explains how to capture, view, inspect, and interpret ICMP packets using Wireshark. # Step 1 — Start Wireshark \u0026amp; Select Your Interface # Open Wireshark. Choose your network interface (usually eth0 or wlan0). Click Start Capturing. # Step 2 — Apply a Basic ICMP Filter # In the filter bar, type:\nicmp Press Enter.\nYou should now only see ICMP packets.\n# Step 3 — Generate ICMP Traffic (Ping) # Run:\nping -c 5 8.8.8.8 Your Wireshark window should begin filling with:\nEcho Request (Type 8) Echo Reply (Type 0) # Step 4 — Inspecting ICMP Packets # Click on any Echo Request packet.\nYou should see three key panels in Wireshark:\n1. Packet List (top) # Shows all captured packets in sequence.\n2. Packet Details (middle) # Shows layers:\nFrame Ethernet IP ICMP 3. Packet Bytes (bottom) # Raw hex representation of the packet.\nExpand:\nInternet Control Message Protocol Internet Protocol Version 4 Look for:\nType: 8 (echo request) Code: 0 Checksum Identifier \u0026amp; Sequence Payload # Step 5 — Observing the ICMP Flow # Ping produces a predictable request/response pattern:\nSource → Destination (Echo Request) Destination → Source (Echo Reply) The IP header shows:\nTTL decreasing as packets travel Source and destination IP addresses Packet length No fragmentation unless payload is large # Step 6 — Capturing ICMP Time Exceeded (Type 11) # To observe TTL expiration, run:\ntraceroute 8.8.8.8 Now apply the filter:\nicmp.type == 11 You should see Time Exceeded packets returned by intermediate routers.\nIf you see no results, your ISP or network may block traceroute packets. Try:\ntraceroute -I 8.8.8.8 (Uses ICMP instead of UDP)\n# Step 7 — Detecting Large ICMP Packets (Tunneling) # To check for suspicious packets:\nicmp \u0026amp;\u0026amp; frame.len \u0026gt; 200 If nothing shows up → good, your network has no large ICMP payloads.\n# Conclusion # ICMP is a necessity for network health, but its simple nature makes it a target for diagnostic tools and covert channels. Understanding its types and transit behavior is essential for any Blue Team operation.\n","date":"16 November 2025","externalUrl":null,"permalink":"/Blog/posts/icmp-protocol/","section":"Posts","summary":"","title":"ICMP Deep Dive: Understanding the Internet Control Message Protocol","type":"posts"},{"content":"","date":"16 November 2025","externalUrl":null,"permalink":"/Blog/tags/networking/","section":"Tags","summary":"","title":"Networking","type":"tags"},{"content":"","date":"16 November 2025","externalUrl":null,"permalink":"/Blog/categories/networking-fundamentals/","section":"Categories","summary":"","title":"Networking Fundamentals","type":"categories"},{"content":"","date":"16 November 2025","externalUrl":null,"permalink":"/Blog/tags/protocol/","section":"Tags","summary":"","title":"Protocol","type":"tags"},{"content":"","externalUrl":null,"permalink":"/Blog/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/Blog/series/","section":"Series","summary":"","title":"Series","type":"series"}]